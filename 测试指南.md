# 数据中心系统测试指南

## 🎯 功能概述
本系统已实现：
- **数据中心统一管理**：所有数据存储在 IndexedDB + localStorage，页面间联动更新
- **飞书表格式编辑**：双击单元格即可编辑，回车/失焦保存，Esc取消
- **批量操作**：多选批量删除，导入/导出 JSON/CSV 文件
- **DEEPSEEK AI 分析**：基于实际表格数据进行智能分析

## 📋 测试步骤

### 1. 数据同步测试
1. 打开 `data.html`，切换到"表格管理"视图
2. 双击任意单元格（项目名称、客户等），修改内容后按回车
3. 打开 `list.html`，验证数据已同步更新
4. 反之，在 `list.html` 添加新项目，回到 `data.html` 刷新查看

### 2. 表格内联编辑测试
1. 在数据表格中双击可编辑单元格（跳过 ID 和时间列）
2. 测试不同类型：
   - **文本输入**：项目名称、客户名称
   - **下拉选择**：状态、区域、项目类型  
   - **数字输入**：采购单价、月租金
   - **复选框**：布尔值字段
3. 验证按键：
   - `Enter` → 保存
   - `Esc` → 取消
   - 失焦 → 自动保存

### 3. 批量操作测试
1. 勾选多个项目的复选框
2. 点击"批量删除"按钮
3. 测试导入功能：准备 JSON 文件（格式参考导出的数据）
4. 测试导出功能：下载当前表格数据

### 4. AI 分析测试
1. **配置 DeepSeek API**：
   - 点击右下角 AI 助手浮动按钮 🤖
   - 点击设置⚙️，选择"DeepSeek（推荐）"
   - 输入你的 DeepSeek API Key
   - 测试连接

2. **触发 AI 分析**：
   - 在数据表格页面点击"⚡AI分析"浮动按钮
   - 系统会自动将当前表格数据发送给 AI
   - 查看 AI 生成的分析报告

3. **快速操作测试**：
   - 📊 数据摘要
   - 📈 利润分析  
   - ⚠️ 风险评估
   - 💡 优化建议

## 🔧 技术实现要点

### 数据存储架构
```javascript
// 主数据源
window.DataCenter = {
    getData: async (tableKey) => dataState.data[tableKey] || [],
    saveData: async (tableKey, data) => { /* 双重存储 */ },
    // ...其他 API
}

// 存储层级：IndexedDB（项目数据）+ localStorage（其他数据）
```

### 表格编辑流程
```
双击单元格 → startCellEdit() → 创建输入控件 → 
监听键盘事件 → commit()/cancel() → saveTableData() → 
更新 IndexedDB/localStorage → 触发其他页面同步
```

### AI 集成配置
- **默认供应商**：DeepSeek（`deepseek-chat` 模型）
- **备选方案**：OpenAI、Azure、Claude、自定义 API
- **数据传输**：当前表格数据（最多前50条）+ 分析提示词

## ⚠️ 注意事项

1. **API Key 安全**：仅存储在本地 localStorage，不会上传
2. **数据限制**：AI 分析时只发送前50条数据避免超过 token 限制
3. **浏览器兼容**：需要支持 IndexedDB 的现代浏览器
4. **内联编辑限制**：ID 和 datetime 字段不可编辑

## 🚀 扩展可能性

- 集成更多 AI 供应商（智谱、文心一言等）
- 实现实时多人协作编辑
- 添加数据验证和约束规则
- 支持更复杂的批量编辑操作
- 集成图表生成和可视化分析

## 📞 问题反馈
如测试中发现问题，请检查：
1. 浏览器控制台是否有错误信息
2. IndexedDB 是否正常工作
3. AI API 配置是否正确
4. 网络连接是否正常