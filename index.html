<!DOCTYPE html>
<html lang="zh-CN">



































































































































































































































































































































































































































































































































































































































































});    }, 2000);        }            showToast('ğŸ‘‹ ç‚¹å‡»"ğŸ¤– æ™ºèƒ½åŠ©æ‰‹"è·å–å¡«è¡¨æŒ‡å¯¼', 'info');        if (!localStorage.getItem('smart-guide-completed')) {    setTimeout(() => {    // æ·»åŠ æ™ºèƒ½æç¤º        });        }            });                }                    }]);                        ...validation                        field: fieldId,                    parameterValidator.showValidationPanel([{                if (validation.warning) {                const validation = parameterValidator.validateField(fieldId, this.value);            field.addEventListener('blur', function() {        if (field) {        const field = document.getElementById(fieldId);    validatedFields.forEach(fieldId => {        const validatedFields = ['monthlyRent', 'purchasePrice', 'leaseTerm', 'exchangeRate'];    // åˆå§‹åŒ–å‚æ•°éªŒè¯document.addEventListener('DOMContentLoaded', function() {// é¡µé¢åŠ è½½æ—¶åˆå§‹åŒ–}    document.getElementById('validationPanel').style.display = 'none';function closeValidationPanel() {}    holidayCalendar.updateCalendar();function updateHolidayCalendar() {}    holidayCalendar.hide();function closeHolidayModal() {}    holidayCalendar.show();function showHolidayModal() {}    sensitivityAnalysis.runAnalysis(param, range);    const range = parseInt(document.getElementById('sensitivityRange').value);    const param = document.getElementById('sensitivityParam').value;function runSensitivityAnalysis() {}    document.getElementById('sensitivityModal').style.display = 'none';function closeSensitivityModal() {}    document.getElementById('sensitivityModal').style.display = 'flex';function showSensitivityAnalysis() {}    smartGuide.nextStep();function nextGuideStep() {}    smartGuide.close();function closeSmartGuide() {}    }        smartGuide.start();    } else {        smartGuide.close();    if (smartFeatures.isGuideActive) {function toggleSmartGuide() {// å…¨å±€å‡½æ•°const holidayCalendar = new HolidayCalendar();const sensitivityAnalysis = new SensitivityAnalysis();const parameterValidator = new ParameterValidator();const smartGuide = new SmartGuide();// å…¨å±€å®ä¾‹}    }        return nextDay;        } while (nextDay.getDay() === 0 || nextDay.getDay() === 6 || this.isHoliday(nextDay, country));            nextDay.setDate(nextDay.getDate() + 1);        do {        let nextDay = new Date(date);    getNextWorkingDay(date, country = 'kazakhstan') {    // è·å–ä¸‹ä¸€ä¸ªå·¥ä½œæ—¥    }        return holidays.some(holiday => holiday.date === dateStr);        const dateStr = date.toISOString().split('T')[0];        const holidays = CENTRAL_ASIA_HOLIDAYS[country]?.[year] || [];        const year = date.getFullYear();    isHoliday(date, country = 'kazakhstan') {    // æ£€æŸ¥ç‰¹å®šæ—¥æœŸæ˜¯å¦ä¸ºèŠ‚å‡æ—¥    }        return names[month];        ];            'ä¸ƒæœˆ', 'å…«æœˆ', 'ä¹æœˆ', 'åæœˆ', 'åä¸€æœˆ', 'åäºŒæœˆ'            '', 'ä¸€æœˆ', 'äºŒæœˆ', 'ä¸‰æœˆ', 'å››æœˆ', 'äº”æœˆ', 'å…­æœˆ',        const names = [    getMonthName(month) {    }        return grouped;        });            grouped[month].push(holiday);            if (!grouped[month]) grouped[month] = [];            const month = date.getMonth() + 1;            const date = new Date(holiday.date);        holidays.forEach(holiday => {        const grouped = {};    groupHolidaysByMonth(holidays) {    }        calendar.innerHTML = html;        html += '</div>';                }            `;                </div>                    </div>            html += `                        }                html += '<div class="no-holidays">æ— èŠ‚å‡æ—¥</div>';            } else {                });                    `;                        </div>                            <div class="holiday-name">${holiday.name}</div>                            <div class="holiday-date">${day}æ—¥</div>                        <div class="holiday-item ${typeClass}">                    html += `                                        const typeClass = holiday.type === 'public' ? 'public-holiday' : 'religious-holiday';                    const day = date.getDate();                    const date = new Date(holiday.date);                monthHolidays.forEach(holiday => {            if (monthHolidays.length > 0) {                        `;                    <div class="month-holidays">                    <h4>${monthName}</h4>                <div class="month-section">            html += `                        const monthHolidays = monthlyHolidays[month] || [];            const monthName = this.getMonthName(month);        for (let month = 1; month <= 12; month++) {                let html = '<div class="holiday-grid">';                const monthlyHolidays = this.groupHolidaysByMonth(holidays);        // æŒ‰æœˆä»½ç»„ç»‡èŠ‚å‡æ—¥        if (!calendar) return;                const calendar = document.getElementById('holidayCalendar');        const holidays = CENTRAL_ASIA_HOLIDAYS[country]?.[year] || [];                const year = document.getElementById('holidayYear')?.value || this.currentYear;        const country = document.getElementById('holidayCountry')?.value || this.currentCountry;    updateCalendar() {    }        document.getElementById('holidayModal').style.display = 'none';    hide() {    }        this.updateCalendar();        document.getElementById('holidayModal').style.display = 'flex';    show() {    }        this.currentCountry = 'kazakhstan';        this.currentYear = 2025;    constructor() {class HolidayCalendar {// èŠ‚å‡æ—¥æ—¥å†ç³»ç»Ÿ};    }        ]            { date: '2025-12-12', name: 'ä¸­æ€§æ—¥', type: 'public' }            { date: '2025-10-28', name: 'ç‹¬ç«‹æ—¥å‡æœŸ', type: 'public' },            { date: '2025-10-27', name: 'ç‹¬ç«‹æ—¥', type: 'public' },            { date: '2025-10-06', name: 'è¿½æ€æ—¥', type: 'public' },            { date: '2025-05-18', name: 'å®ªæ³•æ—¥', type: 'public' },            { date: '2025-05-09', name: 'èƒœåˆ©æ—¥', type: 'public' },            { date: '2025-03-21', name: 'çº³ä¹Œé²å…¹èŠ‚', type: 'public' },            { date: '2025-03-08', name: 'å›½é™…å¦‡å¥³èŠ‚', type: 'public' },            { date: '2025-02-19', name: 'å›½æ——æ—¥', type: 'public' },            { date: '2025-01-12', name: 'è¿½æ€æ—¥', type: 'public' },            { date: '2025-01-01', name: 'å…ƒæ—¦', type: 'public' },        2025: [    turkmenistan: {    },        ]            { date: '2025-11-06', name: 'å®ªæ³•æ—¥', type: 'public' }            { date: '2025-09-09', name: 'ç‹¬ç«‹æ—¥', type: 'public' },            { date: '2025-05-09', name: 'èƒœåˆ©æ—¥', type: 'public' },            { date: '2025-05-01', name: 'åŠ³åŠ¨èŠ‚', type: 'public' },            { date: '2025-03-21', name: 'çº³ä¹Œé²å…¹èŠ‚å‡æœŸ', type: 'public' },            { date: '2025-03-20', name: 'çº³ä¹Œé²å…¹èŠ‚', type: 'public' },            { date: '2025-03-08', name: 'å›½é™…å¦‡å¥³èŠ‚', type: 'public' },            { date: '2025-01-01', name: 'å…ƒæ—¦', type: 'public' },        2025: [    tajikistan: {    },        ]            { date: '2025-11-07', name: 'å†å²ä¸æ–‡åŒ–é—äº§æ—¥', type: 'public' }            { date: '2025-08-31', name: 'ç‹¬ç«‹æ—¥', type: 'public' },            { date: '2025-05-09', name: 'èƒœåˆ©æ—¥', type: 'public' },            { date: '2025-05-01', name: 'åŠ³åŠ¨èŠ‚', type: 'public' },            { date: '2025-03-21', name: 'çº³ä¹Œé²å…¹èŠ‚', type: 'public' },            { date: '2025-03-08', name: 'å›½é™…å¦‡å¥³èŠ‚', type: 'public' },            { date: '2025-02-23', name: 'ç¥–å›½ä¿å«è€…èŠ‚', type: 'public' },            { date: '2025-01-07', name: 'ä¸œæ­£æ•™åœ£è¯èŠ‚', type: 'public' },            { date: '2025-01-01', name: 'å…ƒæ—¦', type: 'public' },        2025: [    kyrgyzstan: {    },        ]            { date: '2025-12-08', name: 'å®ªæ³•æ—¥', type: 'public' }            { date: '2025-10-01', name: 'æ•™å¸ˆèŠ‚', type: 'public' },            { date: '2025-09-01', name: 'ç‹¬ç«‹æ—¥', type: 'public' },            { date: '2025-05-09', name: 'è¿½æ€ä¸è£èª‰æ—¥', type: 'public' },            { date: '2025-03-21', name: 'çº³ä¹Œé²å…¹èŠ‚', type: 'public' },            { date: '2025-03-08', name: 'å›½é™…å¦‡å¥³èŠ‚', type: 'public' },            { date: '2025-01-01', name: 'å…ƒæ—¦', type: 'public' },        2025: [    uzbekistan: {    },        ]            { date: '2025-12-17', name: 'ç‹¬ç«‹æ—¥å‡æœŸ', type: 'public' }            { date: '2025-12-16', name: 'ç‹¬ç«‹æ—¥', type: 'public' },            { date: '2025-12-01', name: 'ç¬¬ä¸€ä»»æ€»ç»Ÿæ—¥', type: 'public' },            { date: '2025-08-30', name: 'å®ªæ³•æ—¥', type: 'public' },            { date: '2025-07-06', name: 'é¦–éƒ½æ—¥', type: 'public' },            { date: '2025-05-09', name: 'èƒœåˆ©æ—¥', type: 'public' },            { date: '2025-05-07', name: 'ç¥–å›½ä¿å«è€…èŠ‚', type: 'public' },            { date: '2025-05-01', name: 'äººæ°‘å›¢ç»“èŠ‚', type: 'public' },            { date: '2025-04-20', name: 'å¤æ´»èŠ‚', type: 'religious' },            { date: '2025-03-21', name: 'çº³ä¹Œé²å…¹èŠ‚', type: 'public' },            { date: '2025-03-08', name: 'å›½é™…å¦‡å¥³èŠ‚', type: 'public' },            { date: '2025-01-07', name: 'ä¸œæ­£æ•™åœ£è¯èŠ‚', type: 'public' },            { date: '2025-01-02', name: 'å…ƒæ—¦å‡æœŸ', type: 'public' },            { date: '2025-01-01', name: 'å…ƒæ—¦', type: 'public' },        2025: [    kazakhstan: {const CENTRAL_ASIA_HOLIDAYS = {// ä¸­äºšäº”å›½èŠ‚å‡æ—¥æ•°æ®}    }        }            return `${paramNames[param]}å¯¹é¡¹ç›®æ”¶ç›Šå½±å“ç›¸å¯¹è¾ƒå°ï¼Œé£é™©å¯æ§ã€‚`;        } else {            return `${paramNames[param]}å¯¹é¡¹ç›®æ”¶ç›Šæœ‰è¾ƒå¤§å½±å“ï¼Œå»ºè®®é‡ç‚¹å…³æ³¨ã€‚`;        } else if (sensitivity > 1) {            return `${paramNames[param]}å¯¹é¡¹ç›®æ”¶ç›Šå½±å“å¾ˆå¤§ï¼Œéœ€è¦è°¨æ…æ§åˆ¶ã€‚`;        if (sensitivity > 2) {        };            insuranceRate: 'ä¿é™©è´¹ç‡'            leaseTerm: 'ç§ŸæœŸ',            exchangeRate: 'æ±‡ç‡',            purchasePrice: 'é‡‡è´­å•ä»·',            monthlyRent: 'æœˆç§Ÿé‡‘',        const paramNames = {    interpretSensitivity(sensitivity, param) {    }        `;            </div>                </div>                    <p><strong>è§£è¯»:</strong> ${this.interpretSensitivity(sensitivity, param)}</p>                <div class="sensitivity-interpretation">                </div>                    </div>                        <span>${sensitivity.toFixed(2)}</span>                        <label>æ•æ„Ÿæ€§ç³»æ•°:</label>                    <div class="result-item">                    </div>                        <span class="negative">${minResult.roi.toFixed(2)}% (${minResult.variation >= 0 ? '+' : ''}${minResult.variation.toFixed(0)}%)</span>                        <label>æœ€ä½ROI:</label>                    <div class="result-item">                    </div>                        <span class="positive">${maxResult.roi.toFixed(2)}% (${maxResult.variation >= 0 ? '+' : ''}${maxResult.variation.toFixed(0)}%)</span>                        <label>æœ€é«˜ROI:</label>                    <div class="result-item">                    </div>                        <span>${baseResult?.roi.toFixed(2)}%</span>                        <label>åŸºå‡†ROI:</label>                    <div class="result-item">                <div class="result-grid">                <h4>ğŸ“Š åˆ†æç»“æœ</h4>            <div class="analysis-summary">        content.innerHTML = `        const sensitivity = roiRange / (range * 2) * 100; // ROIå˜åŠ¨ / å‚æ•°å˜åŠ¨        const roiRange = maxResult.roi - minResult.roi;            current.roi < min.roi ? current : min);        const minResult = results.reduce((min, current) =>             current.roi > max.roi ? current : max);        const maxResult = results.reduce((max, current) =>         const baseResult = results.find(r => Math.abs(r.variation) < 1);        const content = document.getElementById('sensitivityResults');    showResults(results, param, range) {    }        });            }                }                    }                        }                            text: `${paramNames[param]} å˜åŠ¨`                            display: true,                        title: {                    x: {                    },                        }                            text: 'ROI (%)'                            display: true,                        title: {                    y: {                scales: {                },                    }                        position: 'top'                    legend: {                    },                        font: { size: 16 }                        text: `${paramNames[param]} æ•æ„Ÿæ€§åˆ†æ`,                        display: true,                    title: {                plugins: {                maintainAspectRatio: false,                responsive: true,            options: {            },                }]                    tension: 0.4                    fill: true,                    backgroundColor: 'rgba(79, 70, 229, 0.1)',                    borderColor: '#4f46e5',                    data: results.map(r => r.roi),                    label: 'æŠ•èµ„å›æŠ¥ç‡ (ROI)',                datasets: [{                labels: results.map(r => `${r.variation >= 0 ? '+' : ''}${r.variation.toFixed(0)}%`),            data: {            type: 'line',        this.chart = new Chart(ctx, {        };            insuranceRate: 'ä¿é™©è´¹ç‡'            leaseTerm: 'ç§ŸæœŸ',            exchangeRate: 'æ±‡ç‡',            purchasePrice: 'é‡‡è´­å•ä»·',             monthlyRent: 'æœˆç§Ÿé‡‘',        const paramNames = {        }            this.chart.destroy();        if (this.chart) {        if (!ctx) return;        const ctx = document.getElementById('sensitivityChart');    renderChart(results, param) {    }        return { roi, profit, revenue };                const roi = (profit / cost) * 100;        const profit = revenue - cost;        const cost = data.purchasePrice / data.exchangeRate;        const revenue = data.monthlyRent * data.leaseTerm / data.exchangeRate;        // ç®€åŒ–çš„ROIè®¡ç®—ï¼Œåœ¨å®é™…åº”ç”¨ä¸­åº”è¯¥è°ƒç”¨å®Œæ•´çš„è®¡ç®—å™¨    async calculateROI(data) {    }        return results;                }            });                revenue: result.revenue                profit: result.profit,                roi: result.roi,                value: testData[param],                variation: variation,            results.push({            const result = await this.calculateROI(testData);            // ä½¿ç”¨ Web Worker è®¡ç®—æ”¶ç›Š                        testData[param] = baseData[param] * (1 + variation / 100);            const testData = { ...baseData };            const variation = -range + (i * step);        for (let i = 0; i < steps; i++) {                const step = (range * 2) / (steps - 1);        const results = [];        const steps = 11; // -50% to +50% in 10% increments    async calculateSensitivity(param, range, baseData) {    }        };            insuranceRate: parseFloat(document.getElementById('insuranceRate')?.value) || 0.8            leaseTerm: parseInt(document.getElementById('leaseTerm')?.value) || 12,            exchangeRate: parseFloat(document.getElementById('exchangeRate')?.value) || 65,            purchasePrice: parseFloat(document.getElementById('purchasePrice')?.value) || 800000,            monthlyRent: parseFloat(document.getElementById('monthlyRent')?.value) || 50000,        return {    getBaseParameters() {    }        this.showResults(results, param, range);        this.renderChart(results, param);        const results = await this.calculateSensitivity(param, range, baseData);        const baseData = this.getBaseParameters();    async runAnalysis(param, range) {    }        this.chart = null;    constructor() {class SensitivityAnalysis {// æ•æ„Ÿæ€§åˆ†æç³»ç»Ÿ}    }        panel.style.display = 'block';        content.innerHTML = html;        }            html += '</ul></div>';            });                html += `<li>${warning.field}: ${warning.message}</li>`;            warnings.forEach(warning => {            html += '<div class="validation-warnings"><h5>âš ï¸ å»ºè®®</h5><ul>';        if (warnings.length > 0) {        }            html += '</ul></div>';            });                html += `<li>${error.field}: ${error.message}</li>`;            errors.forEach(error => {            html += '<div class="validation-errors"><h5>âŒ é”™è¯¯</h5><ul>';        if (errors.length > 0) {                let html = '';        }            return;            panel.style.display = 'none';        if (warnings.length === 0 && errors.length === 0) {        const errors = validations.filter(v => !v.valid);        const warnings = validations.filter(v => v.warning);                const content = document.getElementById('validationContent');        const panel = document.getElementById('validationPanel');    showValidationPanel(validations) {    }        return { valid: true };        }            };                message: rule.message                warning: true,                valid: true,            return {        if (numValue < rule.recommended[0] || numValue > rule.recommended[1]) {        }            };                message: `å€¼åº”åœ¨${rule.min}-${rule.max}ä¹‹é—´`                 valid: false,             return {         if (numValue < rule.min || numValue > rule.max) {        }            return { valid: false, message: "è¯·è¾“å…¥æœ‰æ•ˆæ•°å­—" };        if (isNaN(numValue)) {        const numValue = parseFloat(value);        if (!rule) return { valid: true };        const rule = this.rules[fieldId];    validateField(fieldId, value) {    }        };            }                message: "æ±‡ç‡å»ºè®®è®¾ä¸º60-70ä¹‹é—´ï¼Œå¯å‚è€ƒè¿‘æœŸå¸‚åœºæ±‡ç‡"                recommended: [60, 70],                max: 80,                min: 50,            exchangeRate: {            },                message: "ç§ŸæœŸå»ºè®®12-24ä¸ªæœˆï¼Œè¿‡çŸ­æ‘Šé”€æˆæœ¬é«˜ï¼Œè¿‡é•¿å¸‚åœºé£é™©å¤§"                recommended: [12, 24],                max: 60,                min: 3,            leaseTerm: {            },                message: "è®¾å¤‡é‡‡è´­ä»·æ ¼å»ºè®®åœ¨50-150ä¸‡å…ƒä¹‹é—´"                recommended: [500000, 1500000],                max: 5000000,                min: 100000,            purchasePrice: {            },                message: "æœˆç§Ÿé‡‘å»ºè®®åœ¨3-8ä¸‡å…ƒä¹‹é—´ï¼Œè¿‡ä½å½±å“æ”¶ç›Šï¼Œè¿‡é«˜ç¼ºä¹ç«äº‰åŠ›"                recommended: [30000, 80000],                max: 200000,                min: 10000,            monthlyRent: {        this.rules = {    constructor() {class ParameterValidator {// å‚æ•°éªŒè¯ç³»ç»Ÿ}    }        this.complete();    close() {    }        showToast('âœ… æ™ºèƒ½å¼•å¯¼å®Œæˆï¼æ‚¨å¯ä»¥å¼€å§‹è®¡ç®—äº†', 'success');        });            el.classList.remove('guide-highlight');        document.querySelectorAll('.guide-highlight').forEach(el => {        smartFeatures.isGuideActive = false;        document.getElementById('smartGuide').style.display = 'none';    complete() {    }        this.showStep(smartFeatures.guideStep);        smartFeatures.guideStep++;        }            return;            showToast('è¯·å…ˆå®Œæˆå½“å‰æ­¥éª¤çš„è®¾ç½®', 'warning');        if (currentStep && currentStep.validation && !currentStep.validation()) {        const currentStep = this.steps[smartFeatures.guideStep];    nextStep() {    }        }            element.scrollIntoView({ behavior: 'smooth', block: 'center' });            element.classList.add('guide-highlight');        if (element) {        const element = document.querySelector(selector);        // æ·»åŠ æ–°çš„é«˜äº®        });            el.classList.remove('guide-highlight');        document.querySelectorAll('.guide-highlight').forEach(el => {        // æ¸…é™¤ä¹‹å‰çš„é«˜äº®    highlightElement(selector) {    }        this.highlightElement(step.target);        // é«˜äº®ç›®æ ‡å…ƒç´         `;            </div>                </div>                    <div class="progress-bar" style="width: ${((stepIndex + 1) / this.steps.length) * 100}%"></div>                <div class="step-progress">                <p>${step.description}</p>                <h4>${step.title}</h4>                <div class="step-number">${stepIndex + 1}/${this.steps.length}</div>            <div class="guide-step active">        guideContent.innerHTML = `                const guideContent = document.getElementById('guideSteps');        const step = this.steps[stepIndex];        }            return;            this.complete();        if (stepIndex >= this.steps.length) {    showStep(stepIndex) {    }        document.getElementById('smartGuide').style.display = 'block';        this.showStep(0);        smartFeatures.guideStep = 0;        smartFeatures.isGuideActive = true;    start() {    }        ];            }                validation: () => parseFloat(document.getElementById('monthlyRent')?.value) > 0                description: "æ ¹æ®å½“åœ°å¸‚åœºè¡Œæƒ…è®¾ç½®æœˆç§Ÿé‡‘ï¼Œå¯å‚è€ƒåŒç±»è®¾å¤‡ä»·æ ¼ã€‚",                target: "#monthlyRent",                title: "5. è®¾ç½®ç§Ÿé‡‘æ”¶å…¥",            {            },                validation: () => document.getElementById('incoterms')?.value                description: "é€‰æ‹©åˆé€‚çš„è´¸æ˜“æœ¯è¯­å†³å®šè¿è¾“è´¹ç”¨åˆ†é…ï¼Œå»ºè®®æ–°æ‰‹é€‰æ‹©CIFã€‚",                target: "#incoterms",                title: "4. é€‰æ‹©è´¸æ˜“æœ¯è¯­",            {            },                validation: () => parseFloat(document.getElementById('purchasePrice')?.value) > 0                description: "è®¾ç½®å‡†ç¡®çš„é‡‡è´­å•ä»·ï¼Œè¿™æ˜¯è®¡ç®—æŠ•èµ„å›æŠ¥çš„åŸºç¡€ã€‚",                target: "#purchasePrice",                title: "3. é…ç½®é‡‡è´­å‚æ•°",            {            },                validation: () => parseInt(document.getElementById('leaseTerm')?.value) >= 3                description: "ç§ŸæœŸé•¿çŸ­ç›´æ¥å½±å“æ€»æ”¶ç›Šï¼Œå»ºè®®12-24ä¸ªæœˆè·å¾—æœ€ä½³æ•ˆæœã€‚",                target: "#leaseTerm",                title: "2. è®¾ç½®ç§ŸæœŸå’Œæ•°é‡",            {            },                validation: () => document.getElementById('equipmentType')?.value                description: "é¦–å…ˆé€‰æ‹©æ‚¨è¦ç§Ÿèµçš„è®¾å¤‡ç±»å‹ï¼Œè¿™å°†å½±å“åç»­çš„å‚æ•°å»ºè®®ã€‚",                target: "#equipmentType",                 title: "1. é€‰æ‹©è®¾å¤‡ç±»å‹",            {        this.steps = [    constructor() {class SmartGuide {// æ™ºèƒ½å¼•å¯¼ç³»ç»Ÿ};    sensitivityChart: null    validationCache: new Map(),    isGuideActive: false,    maxGuideStep: 5,    guideStep: 0,window.smartFeatures = {// å…¨å±€çŠ¶æ€ */<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸­äºšè·¨å¢ƒé¡¹ç›®ç®¡ç†ç³»ç»Ÿ</title>
    <meta http-equiv="refresh" content="0;url=list.html">
    <link rel="stylesheet" href="styles.css">
    <script src="lib/chart.min.js"></script>
    <script>
        // é‡å®šå‘åˆ°é¡¹ç›®åˆ—è¡¨é¡µ
        window.location.href = 'list.html';
    </script>
</head>
<body>
    <div class="app-container">
        <!-- æ™ºèƒ½å¼•å¯¼ç³»ç»Ÿ -->
        <div class="smart-guide" id="smartGuide" style="display:none;">
            <div class="guide-content">
                <h3>ğŸ“‹ æ™ºèƒ½å¡«è¡¨åŠ©æ‰‹</h3>
                <div class="guide-steps" id="guideSteps">
                    <!-- åŠ¨æ€ç”Ÿæˆå¼•å¯¼æ­¥éª¤ -->
                </div>
                <div class="guide-actions">
                    <button class="btn btn-secondary" onclick="closeSmartGuide()">è·³è¿‡å¼•å¯¼</button>
                    <button class="btn btn-primary" onclick="nextGuideStep()">ä¸‹ä¸€æ­¥</button>
                </div>
            </div>
        </div>
        
        <!-- å‚æ•°éªŒè¯æç¤ºé¢æ¿ -->
        <div class="validation-panel" id="validationPanel" style="display:none;">
            <div class="validation-header">
                <h4>âš ï¸ å‚æ•°å»ºè®®</h4>
                <button class="close-btn" onclick="closeValidationPanel()">&times;</button>
            </div>
            <div class="validation-content" id="validationContent">
                <!-- åŠ¨æ€ç”ŸæˆéªŒè¯æç¤º -->
            </div>
        </div>
        
        <!-- é¡¶éƒ¨æ§åˆ¶æ¡ -->
        <header class="control-bar">
            <div class="logo">
                <h1>ğŸšœ ä¸­å“ˆè·¨å¢ƒæœºæ¢°è®¾å¤‡ç§Ÿå”®æµ‹ç®—</h1>
            </div>
            <div class="controls">
                <div class="control-group">
                    <label>ä¸šåŠ¡æ¨¡å¼</label>
                    <div class="toggle-buttons" id="modeToggle">
                        <button class="toggle-btn active" data-value="lease">çº¯ç§Ÿèµ</button>
                        <button class="toggle-btn" data-value="lease-to-sell">ç§Ÿè½¬å”®</button>
                    </div>
                </div>
                <div class="control-group">
                    <label>ä»˜æ¬¾æ–¹å¼</label>
                    <div class="toggle-buttons" id="paymentToggle">
                        <button class="toggle-btn active" data-value="full">å…¨æ¬¾</button>
                        <button class="toggle-btn" data-value="financing">èèµ„ç§Ÿèµ</button>
                    </div>
                </div>
                <div class="control-group">
                    <label>å¸ç§è§†å›¾</label>
                    <div class="toggle-buttons" id="currencyToggle">
                        <button class="toggle-btn active" data-value="CNY">äººæ°‘å¸</button>
                        <button class="toggle-btn" data-value="KZT">åšæˆˆ</button>
                    </div>
                </div>
                <div class="control-group">
                    <label>æƒ…æ™¯</label>
                    <div class="toggle-buttons" id="scenarioToggle">
                        <button class="toggle-btn" data-value="optimistic" title="ç§Ÿé‡‘+10%, è¿è´¹-15%, æ±‡ç‡-8%, ç¨è´¹-10%, è¿è¥-15%">ä¹è§‚</button>
                        <button class="toggle-btn active" data-value="baseline" title="æ‰€æœ‰å‚æ•°æŒ‰è¾“å…¥å€¼è®¡ç®—">åŸºå‡†</button>
                        <button class="toggle-btn" data-value="conservative" title="ç§Ÿé‡‘-15%, è¿è´¹+25%, æ±‡ç‡+15%, ç¨è´¹+10%, è¿è¥+20%">ä¿å®ˆ</button>
                    </div>
                </div>
                <div class="control-group actions">
                    <button class="action-btn" onclick="toggleSmartGuide()">ğŸ¤– æ™ºèƒ½åŠ©æ‰‹</button>
                    <button class="action-btn" onclick="showSensitivityAnalysis()">ğŸ“Š æ•æ„Ÿæ€§åˆ†æ</button>
                    <button class="action-btn" onclick="showHolidayModal()">ğŸ“… èŠ‚å‡æ—¥</button>
                    <button class="action-btn" onclick="generateIntelligentReport()">ğŸ“‹ æ™ºèƒ½æŠ¥å‘Š</button>
                    <button class="action-btn" onclick="showDecisionSupport()">ğŸ¯ å†³ç­–æ”¯æŒ</button>
                    <button class="action-btn" onclick="saveProject()">ğŸ’¾ ä¿å­˜</button>
                    <button class="action-btn primary" onclick="exportPDFReport()">ğŸ“„ å¯¼å‡ºæŠ¥å‘Š</button>
                </div>
            </div>
            <div class="status-bar">
                <span class="scenario-tag" id="scenarioTag">åŸºå‡†æƒ…æ™¯</span>
                <span class="update-time" id="updateTime">æœ€è¿‘æ›´æ–°: --</span>
                <span class="data-status" id="dataStatus">âœ… æ•°æ®å®Œæ•´</span>
            </div>
        </header>

        <main class="main-content">
            <!-- å·¦ä¾§è¾“å…¥åŒº -->
            <aside class="input-panel">
                <!-- B1 é¡¹ç›®ä¿¡æ¯ -->
                <section class="input-section" id="sectionB1">
                    <div class="section-header" onclick="toggleSection('sectionB1')">
                        <h3>ğŸ“‹ B1 é¡¹ç›®ä¿¡æ¯</h3>
                        <span class="collapse-icon">â–¼</span>
                    </div>
                    <div class="section-content">
                        <div class="form-group">
                            <label>è®¾å¤‡å‹å· <span class="hint">å¦‚ï¼šæŒ–æ˜æœºCAT320</span></label>
                            <input type="text" id="equipmentModel" placeholder="è¯·è¾“å…¥è®¾å¤‡å‹å·">
                        </div>
                        <div class="form-group">
                            <label>å°æ•° (N) <span class="required">*</span></label>
                            <input type="number" id="quantity" value="1" min="1" required>
                        </div>
                        <div class="form-group">
                            <label>ç§ŸæœŸ (æœˆ) <span class="required">*</span></label>
                            <input type="number" id="leaseTerm" value="12" min="1" max="120" required>
                        </div>
                        <div class="form-group">
                            <label>é¡¹ç›®æ‰€åœ¨åœ°</label>
                            <select id="projectLocation">
                                <option value="almaty">é˜¿æ‹‰æœ¨å›¾</option>
                                <option value="astana">é˜¿æ–¯å¡”çº³</option>
                                <option value="shymkent">å¥‡å§†è‚¯ç‰¹</option>
                                <option value="other">å…¶ä»–</option>
                            </select>
                        </div>
                    </div>
                </section>

                <!-- B2 æ”¶å…¥å‚æ•° -->
                <section class="input-section" id="sectionB2">
                    <div class="section-header" onclick="toggleSection('sectionB2')">
                        <h3>ğŸ’° B2 æ”¶å…¥å‚æ•°</h3>
                        <span class="collapse-icon">â–¼</span>
                    </div>
                    <div class="section-content">
                        <div class="form-group">
                            <label>å•å°æœˆç§Ÿé‡‘ (CNY) <span class="required">*</span></label>
                            <input type="number" id="monthlyRent" value="50000" min="0" step="1000">
                        </div>
                        <div class="form-group">
                            <label>å®‰è£…è°ƒè¯•è´¹ (CNY/å°)</label>
                            <input type="number" id="installationFee" value="5000" min="0">
                        </div>
                        <div class="form-group">
                            <label>è·¨å¢ƒç»´ä¿æœåŠ¡è´¹ (CNY/å¹´/å°)</label>
                            <input type="number" id="maintenanceServiceFee" value="10000" min="0">
                        </div>
                        <div class="form-group lease-to-sell-only" style="display:none;">
                            <label>æœŸæœ«å‡ºå”®å•ä»· (CNY/å°)</label>
                            <input type="number" id="endSalePrice" value="0" min="0">
                        </div>
                        <div class="form-group lease-to-sell-only" style="display:none;">
                            <label>å¤„ç½®è´¹ç”¨æ¯”ä¾‹ (%)</label>
                            <input type="number" id="disposalFeeRate" value="3" min="0" max="20" step="0.5">
                        </div>
                        <div class="output-preview">
                            <strong>æ”¶å…¥é¢„è§ˆï¼š</strong>
                            <div id="revenuePreview">--</div>
                        </div>
                    </div>
                </section>

                <!-- B3 é‡‡è´­ä¸æ®‹å€¼ -->
                <section class="input-section" id="sectionB3">
                    <div class="section-header" onclick="toggleSection('sectionB3')">
                        <h3>ğŸ­ B3 é‡‡è´­ä¸æ®‹å€¼</h3>
                        <span class="collapse-icon">â–¼</span>
                    </div>
                    <div class="section-content">
                        <div class="form-group">
                            <label>é‡‡è´­å•ä»· (CNY/å°) <span class="required">*</span></label>
                            <input type="number" id="purchasePrice" value="800000" min="0" step="10000">
                        </div>
                        <div class="form-group">
                            <label>ç»æµå¯¿å‘½ (å¹´)</label>
                            <input type="number" id="economicLife" value="10" min="1" max="30">
                        </div>
                        <div class="form-group">
                            <label>ç»§ç»­ç»è¥å¤„ç†æ–¹å¼ <span class="hint">å½±å“åˆ©æ¶¦è®¡ç®—å£å¾„</span></label>
                            <select id="continuingOperationMethod">
                                <option value="accounting">ä¼šè®¡å£å¾„ï¼ˆæŒ‰å¯¿å‘½æ‘Šé”€ï¼‰</option>
                                <option value="cashflow">ç°é‡‘æµå£å¾„ï¼ˆä¸€æ¬¡æ€§æ”¯å‡ºï¼‰</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>æœŸæœ«æ®‹å€¼ç‡ (%)</label>
                            <input type="number" id="residualValueRate" value="10" min="0" max="50" step="1">
                        </div>
                    </div>
                </section>

                <!-- B4 è·¨å¢ƒè¿è¾“ä¸ä¿é™© -->
                <section class="input-section highlight" id="sectionB4">
                    <div class="section-header" onclick="toggleSection('sectionB4')">
                        <h3>ğŸšš B4 è·¨å¢ƒè¿è¾“ä¸ä¿é™©</h3>
                        <span class="collapse-icon">â–¼</span>
                    </div>
                    <div class="section-content">
                        <div class="form-group priority-group">
                            <label>å›½é™…è´¸æ˜“æœ¯è¯­ (Incoterms 2020) <span class="required">*</span></label>
                            <select id="incoterms" onchange="updateTransportResponsibility()">
                                <option value="">-- è¯·é€‰æ‹©è´¸æ˜“æœ¯è¯­ --</option>
                                <option value="EXW">EXW (å·¥å‚äº¤è´§) - ä¹°æ–¹æ‰¿æ‹…å…¨éƒ¨è¿è¾“</option>
                                <option value="FCA">FCA (è´§äº¤æ‰¿è¿äºº) - ä¹°æ–¹æ‰¿æ‹…ä¸»è¦è¿è¾“</option>
                                <option value="FOB">FOB (è£…è¿æ¸¯èˆ¹ä¸Šäº¤è´§) - å¸¸ç”¨äºæµ·è¿</option>
                                <option value="CFR">CFR (æˆæœ¬åŠ è¿è´¹) - å–æ–¹ä»˜å›½é™…è¿è´¹</option>
                                <option value="CIF">CIF (æˆæœ¬+ä¿é™©+è¿è´¹) - å–æ–¹ä»˜è¿è´¹ä¿é™©</option>
                                <option value="DDP">DDP (å®Œç¨åäº¤è´§) - å–æ–¹æ‰¿æ‹…å…¨éƒ¨æˆæœ¬</option>
                            </select>
                        </div>
                        
                        <div class="responsibility-info" id="responsibilityInfo" style="display:none;">
                            <div class="responsibility-summary">
                                <h4>ğŸ“‹ è´¹ç”¨æ‰¿æ‹…è¯´æ˜</h4>
                                <div class="responsibility-grid">
                                    <div class="seller-costs">
                                        <span class="cost-label seller">å–æ–¹æ‰¿æ‹…</span>
                                        <ul id="sellerCosts"></ul>
                                    </div>
                                    <div class="buyer-costs">
                                        <span class="cost-label buyer">ä¹°æ–¹æ‰¿æ‹…</span>
                                        <ul id="buyerCosts"></ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- è¿è¾“è´¹ç”¨è¯¦ç»†è¾“å…¥ -->
                        <div class="transport-costs-section" id="transportCostsSection" style="display:none;">
                            <h4>ğŸ’° ä¹°æ–¹æ‰¿æ‹…è´¹ç”¨æ˜ç»†</h4>
                            
                            <div class="form-group cost-item" id="domesticFreightGroup" style="display:none;">
                                <label>å›½å†…æ®µè¿è´¹ (CNY/å°) <span class="required">*</span> 
                                    <span class="hint">å·¥å‚â†’è£…è¿æ¸¯/è¾¹å¢ƒ</span>
                                </label>
                                <input type="number" id="domesticFreight" value="15000" min="0">
                            </div>
                            
                            <div class="form-group cost-item" id="internationalFreightGroup" style="display:none;">
                                <label>å›½é™…æ®µè¿è´¹ (CNY/å°) <span class="required">*</span> 
                                    <span class="hint">è£…è¿æ¸¯â†’ç›®çš„æ¸¯/è¾¹å¢ƒâ†’é¡¹ç›®åœ°</span>
                                </label>
                                <input type="number" id="internationalFreight" value="25000" min="0">
                            </div>
                            
                            <div class="form-group cost-item" id="portChargesGroup" style="display:none;">
                                <label>å£å²¸æ‚è´¹ (CNY/å°) <span class="hint">è£…å¸/ä»“å‚¨/æ¢è£…/é€šå…³</span></label>
                                <input type="number" id="portCharges" value="8000" min="0">
                            </div>
                            
                            <div class="form-group cost-item" id="insuranceGroup" style="display:none;">
                                <label>è¿è¾“ä¿é™©è´¹ç‡ (%)</label>
                                <input type="number" id="insuranceRate" value="0.8" min="0" max="5" step="0.1">
                                <div class="form-sub-group">
                                    <label>ä¿é™©è®¡è´¹åŸºæ•°</label>
                                    <select id="insuranceBase">
                                        <option value="equipment">è®¾å¤‡è´§å€¼</option>
                                        <option value="cif">å«è¿è´¹ä»·å€¼(CIF)</option>
                                    </select>
                                </div>
                            </div>
                            
                            <div class="form-group cost-item" id="customsGroup" style="display:none;">
                                <label>æ¸…å…³ä»£ç†è´¹ (CNY/å°) <span class="hint">ç›®çš„åœ°æ¸…å…³æœåŠ¡</span></label>
                                <input type="number" id="customsAgentFee" value="3000" min="0">
                            </div>
                            
                            <div class="form-group cost-item" id="importDutyGroup" style="display:none;">
                                <label>è¿›å£å…³ç¨è´¹ç‡ (%) <span class="hint">æŒ‰è®¾å¤‡CIFä»·å€¼è®¡å¾</span></label>
                                <input type="number" id="importDutyRate" value="0" min="0" max="30" step="0.1">
                            </div>
                            
                            <div class="form-group cost-item" id="destinationDeliveryGroup" style="display:none;">
                                <label>ç›®çš„åœ°é…é€è´¹ (CNY/å°) <span class="hint">æ¸…å…³åâ†’é¡¹ç›®å·¥åœ°</span></label>
                                <input type="number" id="destinationDelivery" value="5000" min="0">
                            </div>
                        </div>

                        <div class="output-preview" id="transportPreviewSection" style="display:none;">
                            <strong>ä¹°æ–¹è¿è¾“æˆæœ¬æ±‡æ€»ï¼š</strong>
                            <div id="transportPreview">--</div>
                            <div id="transportRatioIndicator" class="ratio-indicator">--</div>
                            <div class="cost-breakdown" id="costBreakdown">--</div>
                        </div>
                    </div>
                </section>

                <!-- B5 ç¨è´¹å¼•æ“ -->
                <section class="input-section" id="sectionB5">
                    <div class="section-header" onclick="toggleSection('sectionB5')">
                        <h3>ğŸ§¾ B5 ç¨è´¹å¼•æ“</h3>
                        <span class="collapse-icon">â–¼</span>
                    </div>
                    <div class="section-content">
                        <div class="form-group">
                            <label>è®¡ç¨å£å¾„ <span class="required">*</span></label>
                            <select id="taxBasis">
                                <option value="CIF">CIFï¼ˆåˆ°å²¸ä»·ï¼‰</option>
                                <option value="FOB">FOBï¼ˆç¦»å²¸ä»·ï¼‰</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>å®Œç¨ä»·æ ¼æ„æˆ</label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" id="includeGoods" checked disabled> è´§å€¼</label>
                                <label><input type="checkbox" id="includeFreight" checked> å›½é™…è¿è´¹</label>
                                <label><input type="checkbox" id="includeInsurance" checked> ä¿é™©</label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label>å…³ç¨ç¨ç‡ (%) <span class="required">*</span></label>
                            <input type="number" id="tariffRate" value="5" min="0" max="100" step="0.1">
                        </div>
                        <div class="form-group">
                            <label>VAT ç¨ç‡ (%) <span class="required">*</span></label>
                            <input type="number" id="vatRate" value="12" min="0" max="30" step="0.1">
                        </div>
                        <div class="form-group">
                            <label>ç¨æ”¶ä¼˜æƒ </label>
                            <div class="checkbox-group">
                                <label><input type="checkbox" id="tariffExempt"> å…å…³ç¨</label>
                                <label><input type="checkbox" id="vatDeductible"> VATå¯æŠµæ‰£</label>
                            </div>
                        </div>
                        <div class="form-group vat-deduct-only" style="display:none;">
                            <label>VAT å¯æŠµæ‰£æ¯”ä¾‹ (%)</label>
                            <input type="number" id="vatDeductRate" value="100" min="0" max="100">
                        </div>
                        <div class="output-preview">
                            <strong>ç¨è´¹é¢„è§ˆï¼š</strong>
                            <div id="taxPreview">--</div>
                        </div>
                    </div>
                </section>

                <!-- B6 è¿è¥ä¸ç»´ä¿ -->
                <section class="input-section" id="sectionB6">
                    <div class="section-header" onclick="toggleSection('sectionB6')">
                        <h3>ğŸ”§ B6 è¿è¥ä¸ç»´ä¿</h3>
                        <span class="collapse-icon">â–¼</span>
                    </div>
                    <div class="section-content">
                        <div class="form-group">
                            <label>å¹´åº¦è·¨å¢ƒç»´ä¿ (CNY/å°) <span class="hint">äººå‘˜å·®æ—…+äººå·¥</span></label>
                            <input type="number" id="annualMaintenance" value="20000" min="0">
                        </div>
                        <div class="form-group">
                            <label>å½“åœ°é…ä»¶é‡‡è´­ (CNY/å¹´/å°)</label>
                            <input type="number" id="localParts" value="15000" min="0">
                        </div>
                        <div class="form-group">
                            <label>å½“åœ°æœåŠ¡å•†è´¹ç”¨ (CNY/å¹´/å°)</label>
                            <input type="number" id="localServiceFee" value="10000" min="0">
                        </div>
                        <div class="form-group">
                            <label>å…¶ä»–è´¹ç”¨ (CNY/å¹´/å°) <span class="hint">å•†åŠ¡å¯¹æ¥ã€åˆè§„ç­‰</span></label>
                            <input type="number" id="otherOperatingCost" value="5000" min="0">
                        </div>
                        <div class="output-preview">
                            <strong>è¿è¥æˆæœ¬é¢„è§ˆï¼š</strong>
                            <div id="operatingPreview">--</div>
                        </div>
                    </div>
                </section>

                <!-- B7 èµ„é‡‘ä¸èèµ„ -->
                <section class="input-section" id="sectionB7">
                    <div class="section-header" onclick="toggleSection('sectionB7')">
                        <h3>ğŸ’³ B7 èµ„é‡‘ä¸èèµ„</h3>
                        <span class="collapse-icon">â–¼</span>
                    </div>
                    <div class="section-content">
                        <!-- å…¨æ¬¾æ¨¡å¼ -->
                        <div class="payment-mode full-payment-mode">
                            <h4>å…¨æ¬¾å«èµ„å‚æ•°</h4>
                            <div class="form-group">
                                <label>é‡‡è´­å«èµ„æ¯”ä¾‹ (%)</label>
                                <input type="number" id="purchaseAdvanceRate" value="100" min="0" max="100">
                            </div>
                            <div class="form-group">
                                <label>è¿è´¹/ç¨è´¹å«èµ„æ¯”ä¾‹ (%)</label>
                                <input type="number" id="freightTaxAdvanceRate" value="100" min="0" max="100">
                            </div>
                            <div class="form-group">
                                <label>å«èµ„å‘¨æœŸ (æœˆ)</label>
                                <input type="number" id="advancePeriod" value="3" min="1" max="24">
                            </div>
                            <div class="form-group">
                                <label>å¹´åŒ–èµ„é‡‘æˆæœ¬åˆ©ç‡ (%)</label>
                                <input type="number" id="capitalCostRate" value="6" min="0" max="30" step="0.1">
                            </div>
                        </div>
                        <!-- èèµ„æ¨¡å¼ -->
                        <div class="payment-mode financing-mode" style="display:none;">
                            <h4>èèµ„ç§Ÿèµå‚æ•°</h4>
                            <div class="form-group">
                                <label>é¦–ä»˜æ¯”ä¾‹ (%)</label>
                                <input type="number" id="downPaymentRate" value="30" min="0" max="100">
                            </div>
                            <div class="form-group">
                                <label>èèµ„åˆ©ç‡ (å¹´åŒ–%)</label>
                                <input type="number" id="financingRate" value="8" min="0" max="30" step="0.1">
                            </div>
                            <div class="form-group">
                                <label>èèµ„æœŸæ•° (æœˆ)</label>
                                <input type="number" id="financingTerm" value="24" min="1" max="120">
                            </div>
                            <div class="form-group">
                                <label>è¿˜æ¬¾æ–¹å¼</label>
                                <select id="repaymentMethod">
                                    <option value="equal">ç­‰é¢æœ¬æ¯</option>
                                    <option value="bullet">åˆ°æœŸè¿˜æœ¬ä»˜æ¯</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>æ‰‹ç»­è´¹ç‡ (%)</label>
                                <input type="number" id="handlingFeeRate" value="1" min="0" max="10" step="0.1">
                            </div>
                        </div>
                        <div class="output-preview">
                            <strong>èµ„é‡‘æˆæœ¬é¢„è§ˆï¼š</strong>
                            <div id="financingPreview">--</div>
                        </div>
                    </div>
                </section>

                <!-- æ±‡ç‡æ¨¡å— -->
                <section class="input-section" id="sectionExchange">
                    <div class="section-header" onclick="toggleSection('sectionExchange')">
                        <h3>ğŸ’± æ±‡ç‡è®¾ç½®</h3>
                        <span class="collapse-icon">â–¼</span>
                    </div>
                    <div class="section-content">
                        <div class="form-group">
                            <label>ç§Ÿé‡‘æŠ¥ä»·å¸ç§</label>
                            <select id="rentCurrency">
                                <option value="CNY">äººæ°‘å¸ (CNY)</option>
                                <option value="KZT">åšæˆˆ (KZT)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>åŸºå‡†æ±‡ç‡ (1 CNY = ? KZT) <span class="required">*</span></label>
                            <div class="exchange-input-group">
                                <input type="number" id="exchangeRate" value="65" min="1" step="0.01">
                                <button type="button" class="btn-fetch-rate" onclick="fetchExchangeRate()" title="è·å–å®æ—¶æ±‡ç‡">
                                    ğŸ”„ è·å–å®æ—¶æ±‡ç‡
                                </button>
                            </div>
                            <div class="rate-source" id="rateSource"></div>
                        </div>
                        <div class="form-group">
                            <label>æ±‡ç‡æ³¢åŠ¨èŒƒå›´ (Â±%)</label>
                            <input type="number" id="exchangeVolatility" value="5" min="0" max="30" step="1">
                        </div>
                        <div class="exchange-links">
                            <a href="https://www.boc.cn/sourcedb/whpj/" target="_blank" rel="noopener">ğŸ“Š ä¸­å›½é“¶è¡Œå¤–æ±‡ç‰Œä»·</a>
                            <a href="https://www.nationalbank.kz/en/exchangerates/ezhednevnye-oficialnye-rynochnye-kursy-valyut" target="_blank" rel="noopener">ğŸ¦ å“ˆè¨å…‹æ–¯å¦å¤®è¡Œ</a>
                        </div>
                        <div class="output-preview">
                            <strong>æ±‡ç‡æƒ…æ™¯ï¼š</strong>
                            <div id="exchangePreview">--</div>
                        </div>
                    </div>
                </section>

                <div class="calculate-actions">
                    <button class="btn-calculate" onclick="calculate()">ğŸ”„ ç«‹å³æµ‹ç®—</button>
                    <button class="btn-reset" onclick="resetForm()">ğŸ”ƒ é‡ç½®å‚æ•°</button>
                </div>
            </aside>

            <!-- å³ä¾§è¾“å‡ºåŒº -->
            <section class="output-panel">
                <!-- PDFæŠ¥å‘Šå¤´éƒ¨ï¼ˆä»…æ‰“å°æ—¶æ˜¾ç¤ºï¼‰ -->
                <div class="pdf-report-header" style="display:none;">
                    <h1>ğŸšœ ä¸­å“ˆè·¨å¢ƒæœºæ¢°è®¾å¤‡ç§Ÿå”®æµ‹ç®—æŠ¥å‘Š</h1>
                    <div class="report-meta">
                        <span id="reportEquipment">è®¾å¤‡: --</span>
                        <span>|</span>
                        <span id="reportMode">æ¨¡å¼: --</span>
                        <span>|</span>
                        <span id="reportDate">æ—¥æœŸ: --</span>
                    </div>
                </div>

                <!-- æœªè¾¾æ ‡è­¦å‘Šæ¡ -->
                <div class="compliance-alert" id="complianceAlert" style="display:none;">
                    <div class="alert-header">
                        <span class="alert-icon">âš ï¸</span>
                        <span class="alert-title" id="alertTitle">éƒ¨åˆ†æŒ‡æ ‡æœªè¾¾æ ‡</span>
                    </div>
                    <div class="alert-issues" id="alertIssues">
                        <!-- åŠ¨æ€å¡«å…… -->
                    </div>
                </div>

                <!-- ç¡¬æŒ‡æ ‡KPIå¡ç‰‡ï¼š3ç§æ¯›åˆ©ç‡ + 2ç§å›æœ¬ -->
                <div class="kpi-section">
                    <div class="kpi-section-header">
                        <h3>ğŸ“Š æ¯›åˆ©ç‡æŒ‡æ ‡ <span class="threshold-hint">è¾¾æ ‡çº¿ï¼šâ‰¥30%</span></h3>
                    </div>
                    <div class="kpi-cards gm-cards">
                        <div class="kpi-card gm-card" onclick="showKPIDetail('gm1')">
                            <div class="kpi-badge">GM1</div>
                            <div class="kpi-label">ç»è¥æ¯›åˆ©ç‡</div>
                            <div class="kpi-value" id="kpiGM1">--</div>
                            <div class="kpi-indicator" id="kpiGM1Indicator">--</div>
                            <div class="kpi-formula">æ”¶å…¥-å¯å˜æˆæœ¬</div>
                            <div class="kpi-detail-icon">ğŸ“Š</div>
                        </div>
                        <div class="kpi-card gm-card" onclick="showKPIDetail('gm2')">
                            <div class="kpi-badge">GM2</div>
                            <div class="kpi-label">å«æ‘Šé”€æ¯›åˆ©ç‡</div>
                            <div class="kpi-value" id="kpiGM2">--</div>
                            <div class="kpi-indicator" id="kpiGM2Indicator">--</div>
                            <div class="kpi-formula">æ”¶å…¥-å¯å˜-æŠ˜æ—§</div>
                            <div class="kpi-detail-icon">ğŸ“Š</div>
                        </div>
                        <div class="kpi-card gm-card" onclick="showKPIDetail('gm3')">
                            <div class="kpi-badge">GM3</div>
                            <div class="kpi-label">å…¨å£å¾„æ¯›åˆ©ç‡</div>
                            <div class="kpi-value" id="kpiGM3">--</div>
                            <div class="kpi-indicator" id="kpiGM3Indicator">--</div>
                            <div class="kpi-formula">æ”¶å…¥-å¯å˜-æŠ˜æ—§-èµ„é‡‘</div>
                            <div class="kpi-detail-icon">ğŸ“Š</div>
                        </div>
                    </div>
                </div>

                <div class="kpi-section">
                    <div class="kpi-section-header">
                        <h3>â±ï¸ å›æœ¬æŒ‡æ ‡ <span class="threshold-hint">è¾¾æ ‡çº¿ï¼šâ‰¤24ä¸ªæœˆ</span></h3>
                    </div>
                    <div class="kpi-cards pb-cards">
                        <div class="kpi-card pb-card" onclick="showKPIDetail('pb1')">
                            <div class="kpi-badge">PB1</div>
                            <div class="kpi-label">é¡¹ç›®å›æœ¬</div>
                            <div class="kpi-value" id="kpiPB1">--</div>
                            <div class="kpi-unit">æœˆ</div>
                            <div class="kpi-indicator" id="kpiPB1Indicator">--</div>
                            <div class="kpi-formula">ä¸è€ƒè™‘èèµ„</div>
                            <div class="kpi-detail-icon">ğŸ“Š</div>
                        </div>
                        <div class="kpi-card pb-card" onclick="showKPIDetail('pb2')">
                            <div class="kpi-badge">PB2</div>
                            <div class="kpi-label">è‚¡ä¸œå›æœ¬</div>
                            <div class="kpi-value" id="kpiPB2">--</div>
                            <div class="kpi-unit">æœˆ</div>
                            <div class="kpi-indicator" id="kpiPB2Indicator">--</div>
                            <div class="kpi-formula">è€ƒè™‘èèµ„ç»“æ„</div>
                            <div class="kpi-detail-icon">ğŸ“Š</div>
                        </div>
                    </div>
                </div>

                <!-- è¾¾æ ‡é˜ˆå€¼åæ¨ -->
                <div class="threshold-panel" id="thresholdPanel">
                    <div class="threshold-header" onclick="toggleThresholdPanel()">
                        <h3>ğŸ¯ è¾¾æ ‡é˜ˆå€¼åæ¨</h3>
                        <span class="collapse-icon">â–¼</span>
                    </div>
                    <div class="threshold-content">
                        <div class="threshold-group">
                            <h4>æ¯›åˆ©ç‡â‰¥30%æ‰€éœ€æœ€ä½æœˆç§Ÿé‡‘</h4>
                            <div class="threshold-items">
                                <div class="threshold-item">
                                    <span class="label">GM1è¾¾æ ‡</span>
                                    <span class="value" id="thresholdRentGM1">--</span>
                                    <span class="compare" id="thresholdRentGM1Compare"></span>
                                </div>
                                <div class="threshold-item">
                                    <span class="label">GM2è¾¾æ ‡</span>
                                    <span class="value" id="thresholdRentGM2">--</span>
                                    <span class="compare" id="thresholdRentGM2Compare"></span>
                                </div>
                                <div class="threshold-item">
                                    <span class="label">GM3è¾¾æ ‡</span>
                                    <span class="value" id="thresholdRentGM3">--</span>
                                    <span class="compare" id="thresholdRentGM3Compare"></span>
                                </div>
                            </div>
                        </div>
                        <div class="threshold-group">
                            <h4>å›æœ¬â‰¤24ä¸ªæœˆæ‰€éœ€å‚æ•°</h4>
                            <div class="threshold-items">
                                <div class="threshold-item">
                                    <span class="label">æœ€å¤§è·¨å¢ƒæˆæœ¬</span>
                                    <span class="value" id="thresholdMaxTransport">--</span>
                                    <span class="compare" id="thresholdMaxTransportCompare"></span>
                                </div>
                                <div class="threshold-item">
                                    <span class="label">æœ€å¤§èµ„é‡‘åˆ©ç‡</span>
                                    <span class="value" id="thresholdMaxRate">--</span>
                                    <span class="compare" id="thresholdMaxRateCompare"></span>
                                </div>
                                <div class="threshold-item">
                                    <span class="label">æœ€çŸ­å«èµ„å‘¨æœŸ</span>
                                    <span class="value" id="thresholdMinPeriod">--</span>
                                    <span class="compare" id="thresholdMinPeriodCompare"></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- å›¾è¡¨åŒºåŸŸ -->
                <div class="charts-container">
                    <!-- åŒå›æœ¬æ›²çº¿å›¾ -->
                    <div class="chart-card full-width">
                        <div class="chart-header">
                            <h3>ğŸ“ˆ å›æœ¬åˆ†æï¼ˆPB1 vs PB2ï¼‰</h3>
                            <div class="chart-legend">
                                <span class="legend-item"><span class="legend-color pb1"></span>PB1 é¡¹ç›®å›æœ¬</span>
                                <span class="legend-item"><span class="legend-color pb2"></span>PB2 è‚¡ä¸œå›æœ¬</span>
                            </div>
                        </div>
                        <div class="chart-body">
                            <canvas id="paybackChart"></canvas>
                        </div>
                    </div>

                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>ğŸ“Š æˆæœ¬ç»“æ„åˆ†æ</h3>
                            <div class="chart-toggle">
                                <button class="chart-btn active" onclick="switchCostChart('bar')">æŸ±çŠ¶å›¾</button>
                                <button class="chart-btn" onclick="switchCostChart('pie')">ç¯å½¢å›¾</button>
                            </div>
                        </div>
                        <div class="chart-body">
                            <canvas id="costChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>ğŸ“ˆ æœˆåº¦ç°é‡‘æµ</h3>
                        </div>
                        <div class="chart-body">
                            <canvas id="cashFlowChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card full-width">
                        <div class="chart-header">
                            <h3>ğŸ“‰ ç´¯è®¡ç°é‡‘æµä¸å›æœ¬åˆ†æ</h3>
                            <div class="chart-toggle">
                                <label><input type="checkbox" id="showScenarios" onchange="updateCumulativeChart()"> æ˜¾ç¤ºæƒ…æ™¯å¯¹æ¯”</label>
                            </div>
                        </div>
                        <div class="chart-body">
                            <canvas id="cumulativeChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- æ•æ„Ÿæ€§åˆ†æ -->
                <div class="sensitivity-panel">
                    <div class="chart-header">
                        <h3>ğŸ¯ æ•æ„Ÿæ€§åˆ†æ</h3>
                    </div>
                    <div class="sensitivity-controls">
                        <div class="form-group">
                            <label>ç›®æ ‡æŒ‡æ ‡</label>
                            <select id="sensitivityTarget" onchange="updateSensitivity()">
                                <option value="profit">å¹´åº¦åˆ©æ¶¦</option>
                                <option value="payback">å›æœ¬æœˆ</option>
                                <option value="irr">IRR</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>å˜åŠ¨å› ç´ </label>
                            <select id="sensitivityVariable" onchange="updateSensitivity()">
                                <option value="rent">ç§Ÿé‡‘</option>
                                <option value="freight">è¿è´¹</option>
                                <option value="tax">ç¨ç‡</option>
                                <option value="exchange">æ±‡ç‡</option>
                                <option value="interest">åˆ©ç‡</option>
                            </select>
                        </div>
                    </div>
                    <div class="chart-body">
                        <canvas id="sensitivityChart"></canvas>
                    </div>
                </div>

                <!-- æ˜ç»†è¡¨ -->
                <div class="detail-tables">
                    <div class="table-section">
                        <div class="table-header" onclick="toggleTable('revenueTable')">
                            <h3>ğŸ“‹ æ”¶å…¥æ˜ç»†</h3>
                            <span class="collapse-icon">â–¼</span>
                        </div>
                        <div class="table-content" id="revenueTable">
                            <table>
                                <thead>
                                    <tr><th>é¡¹ç›®</th><th>å•ä»·</th><th>æ•°é‡</th><th class="currency-header">é‡‘é¢(CNY)</th></tr>
                                </thead>
                                <tbody id="revenueTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                    <div class="table-section">
                        <div class="table-header" onclick="toggleTable('costTable')">
                            <h3>ğŸ“‹ è·¨å¢ƒæˆæœ¬æ˜ç»†</h3>
                            <span class="collapse-icon">â–¼</span>
                        </div>
                        <div class="table-content" id="costTable">
                            <table>
                                <thead>
                                    <tr><th>é¡¹ç›®</th><th>è®¡ç®—å£å¾„</th><th class="currency-header">é‡‘é¢(CNY)</th><th>å æ¯”</th></tr>
                                </thead>
                                <tbody id="costTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                    <div class="table-section">
                        <div class="table-header" onclick="toggleTable('operatingTable')">
                            <h3>ğŸ“‹ è¿è¥ç»´ä¿æ˜ç»†</h3>
                            <span class="collapse-icon">â–¼</span>
                        </div>
                        <div class="table-content collapsed" id="operatingTable">
                            <table>
                                <thead>
                                    <tr><th>é¡¹ç›®</th><th class="currency-header">å¹´åº¦é‡‘é¢(CNY)</th><th class="currency-header">ç§ŸæœŸæ€»é¢(CNY)</th></tr>
                                </thead>
                                <tbody id="operatingTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                    <div class="table-section">
                        <div class="table-header" onclick="toggleTable('financingTable')">
                            <h3>ğŸ“‹ èèµ„/å«èµ„æ˜ç»†</h3>
                            <span class="collapse-icon">â–¼</span>
                        </div>
                        <div class="table-content collapsed" id="financingTable">
                            <table>
                                <thead>
                                    <tr><th>é¡¹ç›®</th><th class="currency-header">é‡‘é¢(CNY)</th><th>è¯´æ˜</th></tr>
                                </thead>
                                <tbody id="financingTableBody"></tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- PDFæŠ¥å‘Šé¡µè„šï¼ˆä»…æ‰“å°æ—¶æ˜¾ç¤ºï¼‰ -->
                <div class="pdf-report-footer" style="display:none;">
                    <p>æœ¬æŠ¥å‘Šç”±ã€Œä¸­å“ˆè·¨å¢ƒæœºæ¢°è®¾å¤‡ç§Ÿå”®æµ‹ç®—ç³»ç»Ÿã€è‡ªåŠ¨ç”Ÿæˆ | ä»…ä¾›å†…éƒ¨å†³ç­–å‚è€ƒ</p>
                </div>
            </section>
        </main>

        <!-- KPIè¯¦æƒ…å¼¹çª— -->
        <div class="modal" id="kpiModal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modalTitle">KPIè¯¦æƒ…</h3>
                    <button class="modal-close" onclick="closeModal()">Ã—</button>
                </div>
                <div class="modal-body" id="modalBody">
                    <!-- åŠ¨æ€å†…å®¹ -->
                </div>
            </div>
        </div>

        <!-- æ•æ„Ÿæ€§åˆ†æå¼¹çª— -->
        <div class="modal-overlay" id="sensitivityModal" style="display:none;">
            <div class="modal modal-lg">
                <div class="modal-header">
                    <h3>ğŸ“Š æ•æ„Ÿæ€§åˆ†æ</h3>
                    <button class="modal-close" onclick="closeSensitivityModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="sensitivity-controls">
                        <div class="control-group">
                            <label>åˆ†æå‚æ•°:</label>
                            <select id="sensitivityParam">
                                <option value="monthlyRent">æœˆç§Ÿé‡‘</option>
                                <option value="purchasePrice">é‡‡è´­å•ä»·</option>
                                <option value="exchangeRate">æ±‡ç‡</option>
                                <option value="leaseTerm">ç§ŸæœŸ</option>
                                <option value="insuranceRate">ä¿é™©è´¹ç‡</option>
                            </select>
                        </div>
                        <div class="control-group">
                            <label>å˜åŠ¨èŒƒå›´:</label>
                            <select id="sensitivityRange">
                                <option value="10">Â±10%</option>
                                <option value="20" selected>Â±20%</option>
                                <option value="30">Â±30%</option>
                                <option value="50">Â±50%</option>
                            </select>
                        </div>
                        <button class="btn btn-primary" onclick="runSensitivityAnalysis()">è¿è¡Œåˆ†æ</button>
                    </div>
                    <div class="sensitivity-chart-container">
                        <canvas id="sensitivityChart"></canvas>
                    </div>
                    <div class="sensitivity-results" id="sensitivityResults">
                        <!-- åˆ†æç»“æœ -->
                    </div>
                </div>
            </div>
        </div>

        <!-- ä¸­äºšèŠ‚å‡æ—¥æ—¥å†å¼¹çª— -->
        <div class="modal-overlay" id="holidayModal" style="display:none;">
            <div class="modal modal-lg">
                <div class="modal-header">
                    <h3>ğŸ“… ä¸­äºšäº”å›½èŠ‚å‡æ—¥æ—¥å†</h3>
                    <button class="modal-close" onclick="closeHolidayModal()">&times;</button>
                </div>
                <div class="modal-body">
                    <div class="holiday-controls">
                        <select id="holidayCountry" onchange="updateHolidayCalendar()">
                            <option value="kazakhstan">ğŸ‡°ğŸ‡¿ å“ˆè¨å…‹æ–¯å¦</option>
                            <option value="uzbekistan">ğŸ‡ºğŸ‡¿ ä¹Œå…¹åˆ«å…‹æ–¯å¦</option>
                            <option value="kyrgyzstan">ğŸ‡°ğŸ‡¬ å‰å°”å‰æ–¯æ–¯å¦</option>
                            <option value="tajikistan">ğŸ‡¹ğŸ‡¯ å¡”å‰å…‹æ–¯å¦</option>
                            <option value="turkmenistan">ğŸ‡¹ğŸ‡² åœŸåº“æ›¼æ–¯å¦</option>
                        </select>
                        <select id="holidayYear" onchange="updateHolidayCalendar()">
                            <option value="2024">2024å¹´</option>
                            <option value="2025" selected>2025å¹´</option>
                            <option value="2026">2026å¹´</option>
                        </select>
                        <button class="btn btn-secondary" onclick="showHolidayModal()">ğŸ“… æŸ¥çœ‹èŠ‚å‡æ—¥</button>
                    </div>
                    <div class="holiday-calendar" id="holidayCalendar">
                        <!-- èŠ‚å‡æ—¥æ—¥å†å†…å®¹ -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- æ™ºèƒ½æŠ¥å‘Šç”Ÿæˆå¼¹çª— -->
    <div class="modal-overlay" id="reportModal" style="display:none;">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h3>ğŸ“‹ æ™ºèƒ½æŠ¥å‘Šç”Ÿæˆ</h3>
                <button class="modal-close" onclick="closeReportModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="report-options">
                    <div class="option-group">
                        <label>æŠ¥å‘Šç±»å‹</label>
                        <select id="reportType">
                            <option value="executive">é«˜ç®¡æ‘˜è¦æŠ¥å‘Š</option>
                            <option value="comprehensive">ç»¼åˆåˆ†ææŠ¥å‘Š</option>
                            <option value="financial">è´¢åŠ¡åˆ†ææŠ¥å‘Š</option>
                            <option value="technical">æŠ€æœ¯è¯„ä¼°æŠ¥å‘Š</option>
                            <option value="risk">é£é™©è¯„ä¼°æŠ¥å‘Š</option>
                        </select>
                    </div>
                    <div class="option-group">
                        <label>åŒ…å«å†…å®¹</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" id="includeCharts" checked> å›¾è¡¨åˆ†æ</label>
                            <label><input type="checkbox" id="includeCashFlow" checked> ç°é‡‘æµé¢„æµ‹</label>
                            <label><input type="checkbox" id="includeRisk" checked> é£é™©è¯„ä¼°</label>
                            <label><input type="checkbox" id="includeSensitivity" checked> æ•æ„Ÿæ€§åˆ†æ</label>
                        </div>
                    </div>
                    <div class="option-group">
                        <label>è¾“å‡ºæ ¼å¼</label>
                        <div class="radio-group">
                            <label><input type="radio" name="format" value="html" checked> HTML</label>
                            <label><input type="radio" name="format" value="pdf"> PDF</label>
                            <label><input type="radio" name="format" value="excel"> Excel</label>
                        </div>
                    </div>
                </div>
                <div class="report-preview" id="reportPreview">
                    <!-- æŠ¥å‘Šé¢„è§ˆå†…å®¹ -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeReportModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="generateReport()">ç”ŸæˆæŠ¥å‘Š</button>
            </div>
        </div>
    </div>

    <!-- å†³ç­–æ”¯æŒå¼¹çª— -->
    <div class="modal-overlay" id="decisionModal" style="display:none;">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h3>ğŸ¯ æ™ºèƒ½å†³ç­–æ”¯æŒ</h3>
                <button class="modal-close" onclick="closeDecisionModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="decision-dashboard">
                    <div class="score-panel">
                        <div class="overall-score" id="overallScore">
                            <div class="score-circle">
                                <span class="score-value">--</span>
                                <span class="score-label">ç»¼åˆè¯„åˆ†</span>
                            </div>
                        </div>
                        <div class="recommendation" id="recommendation">
                            <h4>æŠ•èµ„å»ºè®®</h4>
                            <div class="rec-level">--</div>
                            <div class="rec-reason">--</div>
                        </div>
                    </div>
                    
                    <div class="criteria-analysis" id="criteriaAnalysis">
                        <h4>è¯„ä¼°æŒ‡æ ‡</h4>
                        <div class="criteria-grid">
                            <div class="criterion-item">
                                <label>æŠ•èµ„å›æŠ¥ç‡</label>
                                <div class="criterion-score">
                                    <div class="score-bar">
                                        <div class="score-fill" data-criterion="roi"></div>
                                    </div>
                                    <span class="score-text" id="roiScore">--</span>
                                </div>
                            </div>
                            <div class="criterion-item">
                                <label>å›æ”¶æœŸ</label>
                                <div class="criterion-score">
                                    <div class="score-bar">
                                        <div class="score-fill" data-criterion="payback"></div>
                                    </div>
                                    <span class="score-text" id="paybackScore">--</span>
                                </div>
                            </div>
                            <div class="criterion-item">
                                <label>å†…éƒ¨æ”¶ç›Šç‡</label>
                                <div class="criterion-score">
                                    <div class="score-bar">
                                        <div class="score-fill" data-criterion="irr"></div>
                                    </div>
                                    <span class="score-text" id="irrScore">--</span>
                                </div>
                            </div>
                            <div class="criterion-item">
                                <label>é£é™©æ°´å¹³</label>
                                <div class="criterion-score">
                                    <div class="score-bar">
                                        <div class="score-fill" data-criterion="risk"></div>
                                    </div>
                                    <span class="score-text" id="riskScore">--</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="risk-assessment" id="riskAssessment">
                        <h4>é£é™©è¯„ä¼°</h4>
                        <div class="risk-summary">
                            <div class="risk-level">é£é™©ç­‰çº§: <span id="riskLevel">--</span></div>
                            <div class="risk-factors" id="riskFactors">
                                <!-- é£é™©å› ç´ åˆ—è¡¨ -->
                            </div>
                        </div>
                    </div>
                    
                    <div class="action-items" id="actionItems">
                        <h4>è¡ŒåŠ¨å»ºè®®</h4>
                        <div class="actions-list">
                            <!-- è¡ŒåŠ¨é¡¹åˆ—è¡¨ -->
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeDecisionModal()">å…³é—­</button>
                <button class="btn btn-primary" onclick="exportDecisionReport()">å¯¼å‡ºå†³ç­–æŠ¥å‘Š</button>
            </div>
        </div>
    </div>

    <!-- æ™ºèƒ½æŠ¥å‘Šç”Ÿæˆå¼¹çª— -->
    <div class="modal-overlay" id="intelligentReportModal" style="display:none;">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h3>ğŸ“‹ æ™ºèƒ½æŠ¥å‘Šç”Ÿæˆ</h3>
                <button class="modal-close" onclick="closeIntelligentReportModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="report-options">
                    <div class="option-group">
                        <label>æŠ¥å‘Šç±»å‹:</label>
                        <select id="reportType">
                            <option value="executive">é«˜ç®¡æ‘˜è¦æŠ¥å‘Š</option>
                            <option value="comprehensive">ç»¼åˆåˆ†ææŠ¥å‘Š</option>
                            <option value="financial">è´¢åŠ¡åˆ†ææŠ¥å‘Š</option>
                            <option value="risk">é£é™©è¯„ä¼°æŠ¥å‘Š</option>
                            <option value="technical">æŠ€æœ¯è¯„ä¼°æŠ¥å‘Š</option>
                        </select>
                    </div>
                    <div class="option-group">
                        <label>åŒ…å«å†…å®¹:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" id="includeCharts" checked> å›¾è¡¨åˆ†æ</label>
                            <label><input type="checkbox" id="includeCashFlow" checked> ç°é‡‘æµåˆ†æ</label>
                            <label><input type="checkbox" id="includeRiskAnalysis" checked> é£é™©è¯„ä¼°</label>
                            <label><input type="checkbox" id="includeSensitivity" checked> æ•æ„Ÿæ€§åˆ†æ</label>
                        </div>
                    </div>
                    <div class="option-group">
                        <label>å¯¼å‡ºæ ¼å¼:</label>
                        <div class="radio-group">
                            <label><input type="radio" name="exportFormat" value="html" checked> HTML</label>
                            <label><input type="radio" name="exportFormat" value="pdf"> PDF</label>
                            <label><input type="radio" name="exportFormat" value="excel"> Excel</label>
                        </div>
                    </div>
                </div>
                <div class="report-preview" id="reportPreview" style="display:none;">
                    <div class="preview-content" id="previewContent"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeIntelligentReportModal()">å–æ¶ˆ</button>
                <button class="btn btn-primary" onclick="generateReportPreview()">ğŸ“Š ç”Ÿæˆé¢„è§ˆ</button>
                <button class="btn btn-success" onclick="exportIntelligentReport()">ğŸ“„ å¯¼å‡ºæŠ¥å‘Š</button>
            </div>
        </div>
    </div>

    <!-- å†³ç­–æ”¯æŒç³»ç»Ÿå¼¹çª— -->
    <div class="modal-overlay" id="decisionSupportModal" style="display:none;">
        <div class="modal-content large-modal">
            <div class="modal-header">
                <h3>ğŸ¯ æ™ºèƒ½å†³ç­–æ”¯æŒ</h3>
                <button class="modal-close" onclick="closeDecisionSupportModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="decision-dashboard">
                    <div class="decision-score">
                        <div class="score-circle" id="overallScoreCircle">
                            <div class="score-value" id="overallScoreValue">--</div>
                            <div class="score-label">ç»¼åˆè¯„åˆ†</div>
                        </div>
                    </div>
                    <div class="decision-recommendation" id="decisionRecommendation">
                        <h4>æŠ•èµ„å»ºè®®</h4>
                        <div class="recommendation-content">ç‚¹å‡»"åˆ†ææŠ•èµ„"æŒ‰é’®è·å–æ™ºèƒ½å»ºè®®</div>
                    </div>
                </div>
                
                <div class="criteria-analysis" id="criteriaAnalysis" style="display:none;">
                    <h4>æŒ‡æ ‡è¯„åˆ†</h4>
                    <div class="criteria-grid">
                        <div class="criteria-item">
                            <div class="criteria-label">æŠ•èµ„å›æŠ¥ç‡</div>
                            <div class="criteria-bar">
                                <div class="criteria-fill roi-fill" id="roiBar"></div>
                                <div class="criteria-value" id="roiScore">--</div>
                            </div>
                        </div>
                        <div class="criteria-item">
                            <div class="criteria-label">å›æ”¶æœŸ</div>
                            <div class="criteria-bar">
                                <div class="criteria-fill payback-fill" id="paybackBar"></div>
                                <div class="criteria-value" id="paybackScore">--</div>
                            </div>
                        </div>
                        <div class="criteria-item">
                            <div class="criteria-label">å†…éƒ¨æ”¶ç›Šç‡</div>
                            <div class="criteria-bar">
                                <div class="criteria-fill irr-fill" id="irrBar"></div>
                                <div class="criteria-value" id="irrScore">--</div>
                            </div>
                        </div>
                        <div class="criteria-item">
                            <div class="criteria-label">é£é™©è¯„ä¼°</div>
                            <div class="criteria-bar">
                                <div class="criteria-fill risk-fill" id="riskBar"></div>
                                <div class="criteria-value" id="riskScore">--</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="action-items" id="actionItems" style="display:none;">
                    <h4>è¡ŒåŠ¨å»ºè®®</h4>
                    <div class="action-list" id="actionList"></div>
                </div>

                <div class="risk-assessment" id="riskAssessmentDetails" style="display:none;">
                    <h4>é£é™©è¯„ä¼°è¯¦æƒ…</h4>
                    <div class="risk-content" id="riskContent"></div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-secondary" onclick="closeDecisionSupportModal()">å…³é—­</button>
                <button class="btn btn-primary" onclick="analyzeInvestmentDecision()">ğŸ§  åˆ†ææŠ•èµ„</button>
                <button class="btn btn-success" onclick="exportDecisionReport()">ğŸ“Š å¯¼å‡ºåˆ†æ</button>
            </div>
        </div>
    </div>

    <script src="calculator.js"></script>
    <script src="charts.js"></script>
    <script src="app.js"></script>
    <script src="pdf-export.js"></script>
    <script src="ai-assistant.js"></script>
    <script src="smart-features.js"></script>
    <script src="intelligent-reporting.js"></script>
    <script src="performance-optimization.js"></script>
</body>
</html>
